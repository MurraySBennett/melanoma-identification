---
title: "exp-sim"
author: "Murray S Bennett"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

```

## Simulate BTL model using experiment design

Random competition generation and BTL model analysis as you will be doing it.

```{r echo=FALSE}

n_players <- 4
n_trials <- 10

players <- seq(1, n_players)
sim_col_names <- c("player1", "player2", "winner")
data <- data.frame(matrix(ncol=3, nrow=n_trials, dimnames=list(NULL, sim_col_names)))

get_contests <- function(p_list, trials){
  players <- sample(p_list, trials * 2, replace = T)
  contests <- matrix(players, nrow = trials, byrow = T)
  
  no_mates <- contests[, 1] == contests[, 2]
  while (sum(no_mates > 0)){
    contests[no_mates, 1] <- sample(p_list, sum(no_mates), replace=T)
    no_mates <- contests[, 1] == contests[, 2]
  }
  
  return(contests)
}

data[, 1:2] <- get_contests(players, n_trials)
```
